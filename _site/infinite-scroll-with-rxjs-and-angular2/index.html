<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="index, follow">
    

    <title>Infinite scroll in Angular an RxJS</title>


     
        <meta name="description" content="This article explains how the "reactive-programming" approach helps us to create an awesome infinite-scroll-list in only a few lines of code. For this article, we are going to use RxJS and Angular.">
    


    <!-- Stylesheet -->
    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="https://blog.brecht.io/infinite-scroll-with-rxjs-and-angular2/">

    <!-- Google Fonts -->
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Alegreya:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/styles/default.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>

    <!-- Favicon -->
    <link rel="shortcut icon" href="/img/favicon.png" />
</head>

<body>
    <svg style="display: none;"><symbol viewBox="0 0 16 14" id="icon-behance"><title>behance</title> <path d="M14.438 2.648h-3.992v0.969h3.992v-0.969zM12.469 5.977q-0.703 0-1.141 0.41t-0.484 1.113h3.188q-0.141-1.523-1.563-1.523zM12.594 10.547q0.492 0 0.953-0.25t0.594-0.68h1.727q-0.781 2.398-3.336 2.398-1.672 0-2.66-1.031t-0.988-2.711q0-1.625 1.020-2.699t2.629-1.074q1.078 0 1.879 0.531t1.195 1.398 0.395 1.937q0 0.133-0.016 0.367h-5.141q0 0.867 0.449 1.34t1.301 0.473zM2.164 10.156h2.313q1.602 0 1.602-1.305 0-1.406-1.555-1.406h-2.359v2.711zM2.164 5.961h2.195q0.609 0 0.965-0.285t0.355-0.887q0-1.125-1.484-1.125h-2.031v2.297zM0 1.984h4.641q0.68 0 1.211 0.109t0.988 0.371 0.703 0.754 0.246 1.203q0 1.414-1.344 2.055 0.891 0.25 1.344 0.898t0.453 1.594q0 0.586-0.191 1.066t-0.516 0.809-0.77 0.555-0.945 0.328-1.047 0.102h-4.773v-9.844z"/> </symbol><symbol viewBox="0 0 8 14" id="icon-facebook"><title>facebook</title> <path d="M7.492 0.094v2.062h-1.227q-0.672 0-0.906 0.281t-0.234 0.844v1.477h2.289l-0.305 2.313h-1.984v5.93h-2.391v-5.93h-1.992v-2.313h1.992v-1.703q0-1.453 0.813-2.254t2.164-0.801q1.148 0 1.781 0.094z"/> </symbol><symbol viewBox="0 0 11 14" id="icon-feed"><title>feed</title> <path d="M3 10.5q0 0.625-0.438 1.062t-1.062 0.438-1.062-0.438-0.438-1.062 0.438-1.062 1.062-0.438 1.062 0.438 0.438 1.062zM7 11.461q0.016 0.219-0.133 0.375-0.141 0.164-0.367 0.164h-1.055q-0.195 0-0.336-0.129t-0.156-0.324q-0.172-1.789-1.441-3.059t-3.059-1.441q-0.195-0.016-0.324-0.156t-0.129-0.336v-1.055q0-0.227 0.164-0.367 0.133-0.133 0.336-0.133h0.039q1.25 0.102 2.391 0.629t2.023 1.418q0.891 0.883 1.418 2.023t0.629 2.391zM11 11.477q0.016 0.211-0.141 0.367-0.141 0.156-0.359 0.156h-1.117q-0.203 0-0.348-0.137t-0.152-0.332q-0.094-1.68-0.789-3.191t-1.809-2.625-2.625-1.809-3.191-0.797q-0.195-0.008-0.332-0.152t-0.137-0.34v-1.117q0-0.219 0.156-0.359 0.141-0.141 0.344-0.141h0.023q2.047 0.102 3.918 0.937t3.324 2.297q1.461 1.453 2.297 3.324t0.937 3.918z"/> </symbol><symbol viewBox="0 0 14 14" id="icon-git"><title>git</title> <path d="M4.648 11.828q0-0.781-1.289-0.781-1.234 0-1.234 0.813 0 0.789 1.344 0.789 1.18 0 1.18-0.82zM4.188 5.93q0-0.477-0.234-0.797t-0.695-0.32q-0.969 0-0.969 1.133 0 1.055 0.969 1.055 0.93 0 0.93-1.070zM6.289 3.398v1.578q-0.281 0.094-0.617 0.172 0.125 0.336 0.125 0.656 0 0.992-0.57 1.691t-1.539 0.879q-0.312 0.062-0.465 0.211t-0.152 0.453q0 0.242 0.176 0.402t0.453 0.25 0.613 0.172 0.672 0.199 0.613 0.293 0.453 0.5 0.176 0.77q0 2.375-2.836 2.375-0.539 0-1.016-0.098t-0.906-0.32-0.684-0.641-0.254-0.996q0-1.289 1.422-1.758v-0.031q-0.523-0.32-0.523-0.984 0-0.852 0.492-1.070v-0.031q-0.563-0.187-0.934-0.848t-0.371-1.293q0-1.086 0.742-1.809t1.836-0.723q0.75 0 1.391 0.367 0.766 0 1.703-0.367zM8.773 10.281h-1.734q0.031-0.352 0.031-1.047v-4.758q0-0.734-0.031-1h1.734q-0.031 0.258-0.031 0.969v4.789q0 0.695 0.031 1.047zM13.469 8.547v1.531q-0.555 0.305-1.359 0.305-0.484 0-0.836-0.156t-0.547-0.391-0.309-0.609-0.145-0.719-0.031-0.805v-2.742h0.016v-0.031q-0.055 0-0.148-0.008t-0.141-0.008q-0.164 0-0.461 0.047v-1.484h0.75v-0.594q0-0.422-0.047-0.695h1.773q-0.047 0.32-0.047 1.289h1.336v1.484q-0.117 0-0.34-0.016t-0.332-0.016h-0.664v2.852q0 1.023 0.68 1.023 0.477 0 0.852-0.258zM8.969 1.148q0 0.453-0.305 0.793t-0.75 0.34q-0.453 0-0.766-0.34t-0.312-0.793q0-0.461 0.309-0.805t0.77-0.344q0.453 0 0.754 0.348t0.301 0.801z"/> </symbol><symbol viewBox="0 0 12 14" id="icon-github"><title>github</title> <path d="M12 7q0 1.961-1.145 3.527t-2.957 2.168q-0.211 0.039-0.309-0.055t-0.098-0.234v-1.648q0-0.758-0.406-1.109 0.445-0.047 0.801-0.141t0.734-0.305 0.633-0.52 0.414-0.82 0.16-1.176q0-0.945-0.617-1.609 0.289-0.711-0.062-1.594-0.219-0.070-0.633 0.086t-0.719 0.344l-0.297 0.187q-0.727-0.203-1.5-0.203t-1.5 0.203q-0.125-0.086-0.332-0.211t-0.652-0.301-0.672-0.105q-0.344 0.883-0.055 1.594-0.617 0.664-0.617 1.609 0 0.664 0.16 1.172t0.41 0.82 0.629 0.523 0.734 0.305 0.801 0.141q-0.312 0.281-0.383 0.805-0.164 0.078-0.352 0.117t-0.445 0.039-0.512-0.168-0.434-0.488q-0.148-0.25-0.379-0.406t-0.387-0.187l-0.156-0.023q-0.164 0-0.227 0.035t-0.039 0.090 0.070 0.109 0.102 0.094l0.055 0.039q0.172 0.078 0.34 0.297t0.246 0.398l0.078 0.18q0.102 0.297 0.344 0.48t0.523 0.234 0.543 0.055 0.434-0.027l0.18-0.031q0 0.297 0.004 0.695t0.004 0.422q0 0.141-0.102 0.234t-0.312 0.055q-1.812-0.602-2.957-2.168t-1.145-3.527q0-1.633 0.805-3.012t2.184-2.184 3.012-0.805 3.012 0.805 2.184 2.184 0.805 3.012z"/> </symbol><symbol viewBox="0 0 13 14" id="icon-google-plus"><title>google-plus</title> <path d="M5.742 6.219q0 0.281 0.25 0.551t0.605 0.531 0.707 0.574 0.602 0.813 0.25 1.109q0 0.703-0.375 1.352-0.563 0.953-1.648 1.402t-2.328 0.449q-1.031 0-1.926-0.324t-1.34-1.074q-0.289-0.469-0.289-1.023 0-0.633 0.348-1.172t0.926-0.898q1.023-0.641 3.156-0.781-0.25-0.328-0.371-0.578t-0.121-0.57q0-0.281 0.164-0.664-0.359 0.031-0.531 0.031-1.156 0-1.949-0.754t-0.793-1.91q0-0.641 0.281-1.242t0.773-1.023q0.602-0.516 1.426-0.766t1.699-0.25h3.266l-1.078 0.688h-1.023q0.578 0.492 0.875 1.039t0.297 1.25q0 0.563-0.191 1.012t-0.461 0.727-0.543 0.508-0.465 0.48-0.191 0.516zM4.602 5.469q0.297 0 0.609-0.129t0.516-0.34q0.414-0.445 0.414-1.242 0-0.453-0.133-0.977t-0.379-1.012-0.66-0.809-0.914-0.32q-0.328 0-0.645 0.152t-0.512 0.41q-0.367 0.461-0.367 1.25 0 0.359 0.078 0.762t0.246 0.805 0.406 0.723 0.586 0.523 0.754 0.203zM4.617 12.289q0.453 0 0.871-0.102t0.773-0.305 0.57-0.57 0.215-0.852q0-0.195-0.055-0.383t-0.113-0.328-0.211-0.324-0.23-0.273-0.301-0.27-0.285-0.227-0.324-0.234-0.285-0.203q-0.125-0.016-0.375-0.016-0.414 0-0.82 0.055t-0.84 0.195-0.758 0.359-0.535 0.582-0.211 0.824q0 0.547 0.273 0.965t0.715 0.648 0.93 0.344 0.996 0.113zM10.945 5.445h1.664v0.844h-1.664v1.711h-0.82v-1.711h-1.656v-0.844h1.656v-1.695h0.82v1.695z"/> </symbol><symbol viewBox="0 0 12 14" id="icon-instagram"><title>instagram</title> <path d="M10.641 11.141v-5.063h-1.055q0.156 0.492 0.156 1.023 0 0.984-0.5 1.816t-1.359 1.316-1.875 0.484q-1.539 0-2.633-1.059t-1.094-2.559q0-0.531 0.156-1.023h-1.102v5.063q0 0.203 0.137 0.34t0.34 0.137h8.352q0.195 0 0.336-0.137t0.141-0.34zM8.422 6.977q0-0.969-0.707-1.652t-1.707-0.684q-0.992 0-1.699 0.684t-0.707 1.652 0.707 1.652 1.699 0.684q1 0 1.707-0.684t0.707-1.652zM10.641 4.164v-1.289q0-0.219-0.156-0.379t-0.383-0.16h-1.359q-0.227 0-0.383 0.16t-0.156 0.379v1.289q0 0.227 0.156 0.383t0.383 0.156h1.359q0.227 0 0.383-0.156t0.156-0.383zM12 2.539v8.922q0 0.633-0.453 1.086t-1.086 0.453h-8.922q-0.633 0-1.086-0.453t-0.453-1.086v-8.922q0-0.633 0.453-1.086t1.086-0.453h8.922q0.633 0 1.086 0.453t0.453 1.086z"/> </symbol><symbol viewBox="0 0 12 14" id="icon-linkedin"><title>linkedin</title> <path d="M2.727 4.883v7.742h-2.578v-7.742h2.578zM2.891 2.492q0.008 0.57-0.395 0.953t-1.059 0.383h-0.016q-0.641 0-1.031-0.383t-0.391-0.953q0-0.578 0.402-0.957t1.051-0.379 1.039 0.379 0.398 0.957zM12 8.187v4.437h-2.57v-4.141q0-0.82-0.316-1.285t-0.988-0.465q-0.492 0-0.824 0.27t-0.496 0.668q-0.086 0.234-0.086 0.633v4.32h-2.57q0.016-3.117 0.016-5.055t-0.008-2.313l-0.008-0.375h2.57v1.125h-0.016q0.156-0.25 0.32-0.438t0.441-0.406 0.68-0.34 0.895-0.121q1.336 0 2.148 0.887t0.813 2.598z"/> </symbol><symbol viewBox="0 0 114.25 36.375" id="icon-logo"><title>logo</title> <g> <path d="M0.864,2.65c-0.5-1.45,0.15-2.4,1.7-2.4h2.65c1.2,0,2,0.55,2.35,1.75l7.25,21.401
		c0.65,2.05,1.35,5.2,1.35,5.2h0.1c0,0,0.65-3.15,1.35-5.2L24.965,2c0.3-1.2,1.1-1.75,2.3-1.75h2.55c1.55,0,2.2,0.95,1.7,2.4
		L20.165,34.102c-0.4,1.15-1.15,1.65-2.35,1.65h-3.2c-1.2,0-1.95-0.5-2.35-1.65L0.864,2.65z"/> <path d="M36.263,2.351c0-1.35,0.7-2.1,2.05-2.1h2.3c1.35,0,2.05,0.75,2.05,2.1v31.302c0,1.4-0.7,2.1-2.05,2.1h-2.3
		c-1.35,0-2.05-0.7-2.05-2.1V2.351z"/> <path d="M50.863,2.351c0-1.35,0.7-2.1,2.05-2.1h10.051c10.95,0,18.101,6.5,18.101,17.701
		s-7.15,17.801-18.101,17.801H52.913c-1.35,0-2.05-0.7-2.05-2.1V2.351z M62.613,30.202c7.201,0,11.801-4.25,11.801-12.251
		c0-7.9-4.7-12.15-11.801-12.15h-5.35v24.401H62.613z"/> <path d="M94.713,1.95c0.4-1.15,1.15-1.7,2.351-1.7h3.2c1.2,0,2,0.55,2.35,1.7l11.102,31.402
		c0.5,1.45-0.15,2.4-1.7,2.4h-2.301c-1.2,0-2-0.55-2.35-1.7l-2.5-7.4H92.413l-2.45,7.351c-0.35,1.2-1.15,1.75-2.35,1.75h-2.301
		c-1.55,0-2.2-0.95-1.7-2.4L94.713,1.95z M103.264,21.401l-3.15-9.5c-0.6-2-1.399-5.5-1.399-5.5h-0.101c0,0-0.8,3.5-1.4,5.5
		l-3.199,9.5H103.264z"/> </g> </symbol><symbol viewBox="0 0 10 14" id="icon-pinterest-p"><title>pinterest-p</title> <path d="M0 4.664q0-0.844 0.293-1.59t0.809-1.301 1.187-0.961 1.445-0.609 1.578-0.203q1.234 0 2.297 0.52t1.727 1.512 0.664 2.242q0 0.75-0.148 1.469t-0.469 1.383-0.781 1.168-1.133 0.805-1.477 0.301q-0.531 0-1.055-0.25t-0.75-0.688q-0.078 0.305-0.219 0.879t-0.184 0.742-0.16 0.555-0.203 0.555-0.25 0.488-0.359 0.605-0.484 0.676l-0.109 0.039-0.070-0.078q-0.117-1.227-0.117-1.469 0-0.719 0.168-1.613t0.52-2.246 0.406-1.586q-0.25-0.508-0.25-1.32 0-0.648 0.406-1.219t1.031-0.57q0.477 0 0.742 0.316t0.266 0.801q0 0.516-0.344 1.492t-0.344 1.461q0 0.492 0.352 0.816t0.852 0.324q0.43 0 0.797-0.195t0.613-0.531 0.438-0.742 0.297-0.863 0.156-0.867 0.051-0.777q0-1.352-0.855-2.105t-2.23-0.754q-1.563 0-2.609 1.012t-1.047 2.566q0 0.344 0.098 0.664t0.211 0.508 0.211 0.355 0.098 0.238q0 0.219-0.117 0.57t-0.289 0.352q-0.016 0-0.133-0.023-0.398-0.117-0.707-0.438t-0.477-0.738-0.254-0.844-0.086-0.832z"/> </symbol><symbol viewBox="0 0 12 14" id="icon-skype"><title>skype</title> <path d="M9.164 8.305q0-0.391-0.152-0.715t-0.379-0.535-0.57-0.383-0.645-0.266-0.684-0.18l-0.813-0.187q-0.234-0.055-0.344-0.082t-0.273-0.090-0.234-0.125-0.129-0.164-0.059-0.234q0-0.602 1.125-0.602 0.336 0 0.602 0.094t0.422 0.223 0.297 0.262 0.312 0.227 0.375 0.094q0.367 0 0.59-0.25t0.223-0.602q0-0.43-0.438-0.777t-1.109-0.527-1.422-0.18q-0.531 0-1.031 0.121t-0.934 0.367-0.695 0.68-0.262 1.004q0 0.477 0.148 0.832t0.438 0.59 0.625 0.379 0.805 0.254l1.141 0.281q0.703 0.172 0.875 0.281 0.25 0.156 0.25 0.469 0 0.305-0.312 0.504t-0.82 0.199q-0.398 0-0.715-0.125t-0.508-0.301-0.355-0.352-0.359-0.301-0.422-0.125q-0.391 0-0.59 0.234t-0.199 0.586q0 0.719 0.953 1.23t2.273 0.512q0.57 0 1.094-0.145t0.957-0.418 0.691-0.73 0.258-1.027zM12 10q0 1.242-0.879 2.121t-2.121 0.879q-1.016 0-1.828-0.625-0.602 0.125-1.172 0.125-1.117 0-2.137-0.434t-1.758-1.172-1.172-1.758-0.434-2.137q0-0.57 0.125-1.172-0.625-0.813-0.625-1.828 0-1.242 0.879-2.121t2.121-0.879q1.016 0 1.828 0.625 0.602-0.125 1.172-0.125 1.117 0 2.137 0.434t1.758 1.172 1.172 1.758 0.434 2.137q0 0.57-0.125 1.172 0.625 0.813 0.625 1.828z"/> </symbol><symbol viewBox="0 0 13 14" id="icon-twitter"><title>twitter</title> <path d="M12.656 3.188q-0.523 0.766-1.266 1.305 0.008 0.109 0.008 0.328 0 1.016-0.297 2.027t-0.902 1.941-1.441 1.645-2.016 1.141-2.523 0.426q-2.117 0-3.875-1.133 0.273 0.031 0.609 0.031 1.758 0 3.133-1.078-0.82-0.016-1.469-0.504t-0.891-1.246q0.258 0.039 0.477 0.039 0.336 0 0.664-0.086-0.875-0.18-1.449-0.871t-0.574-1.605v-0.031q0.531 0.297 1.141 0.32-0.516-0.344-0.82-0.898t-0.305-1.203q0-0.688 0.344-1.273 0.945 1.164 2.301 1.863t2.902 0.777q-0.062-0.297-0.062-0.578 0-1.047 0.738-1.785t1.785-0.738q1.094 0 1.844 0.797 0.852-0.164 1.602-0.609-0.289 0.898-1.109 1.391 0.727-0.078 1.453-0.391z"/> </symbol><symbol viewBox="0 0 12 14" id="icon-vine"><title>vine</title> <path d="M11.695 6.461v1.547q-0.789 0.18-1.547 0.18-0.508 1.062-1.293 2.117t-1.418 1.684-1 0.832q-0.625 0.352-1.266-0.023-0.219-0.133-0.473-0.34t-0.664-0.652-0.801-1.004-0.84-1.438-0.824-1.906-0.715-2.457-0.551-3.047h2.211q0.203 1.703 0.547 3.113t0.816 2.477 0.949 1.84 1.094 1.523q1.32-1.32 2.242-3.172-1.109-0.563-1.742-1.719t-0.633-2.602q0-1.5 0.813-2.457t2.219-0.957q1.391 0 2.133 0.824t0.742 2.324q0 1.242-0.453 2.234-0.055 0.008-0.152 0.023t-0.359 0.016-0.492-0.047-0.484-0.199-0.395-0.402q0.242-0.805 0.242-1.438 0-0.68-0.227-1.031t-0.617-0.352q-0.414 0-0.664 0.387t-0.25 1.098q0 1.453 0.82 2.293t2.086 0.84q0.484 0 0.945-0.109z"/> </symbol><symbol viewBox="0 0 12 14" id="icon-youtube"><title>youtube</title> <path d="M7.586 9.719v1.648q0 0.523-0.305 0.523-0.18 0-0.352-0.172v-2.352q0.172-0.172 0.352-0.172 0.305 0 0.305 0.523zM10.227 9.727v0.359h-0.703v-0.359q0-0.531 0.352-0.531t0.352 0.531zM2.68 8.023h0.836v-0.734h-2.438v0.734h0.82v4.445h0.781v-4.445zM4.93 12.469h0.695v-3.859h-0.695v2.953q-0.234 0.328-0.445 0.328-0.141 0-0.164-0.164-0.008-0.023-0.008-0.273v-2.844h-0.695v3.055q0 0.383 0.062 0.57 0.094 0.289 0.453 0.289 0.375 0 0.797-0.477v0.422zM8.281 11.313v-1.539q0-0.57-0.070-0.773-0.133-0.438-0.555-0.438-0.391 0-0.727 0.422v-1.695h-0.695v5.18h0.695v-0.375q0.352 0.43 0.727 0.43 0.422 0 0.555-0.43 0.070-0.211 0.070-0.781zM10.922 11.234v-0.102h-0.711q0 0.398-0.016 0.477-0.055 0.281-0.312 0.281-0.359 0-0.359-0.539v-0.68h1.398v-0.805q0-0.617-0.211-0.906-0.305-0.398-0.828-0.398-0.531 0-0.836 0.398-0.219 0.289-0.219 0.906v1.352q0 0.617 0.227 0.906 0.305 0.398 0.844 0.398 0.563 0 0.844-0.414 0.141-0.211 0.164-0.422 0.016-0.070 0.016-0.453zM6.172 4.102v-1.641q0-0.539-0.336-0.539t-0.336 0.539v1.641q0 0.547 0.336 0.547t0.336-0.547zM11.789 9.969q0 1.828-0.203 2.734-0.109 0.461-0.453 0.773t-0.797 0.359q-1.438 0.164-4.336 0.164t-4.336-0.164q-0.453-0.047-0.801-0.359t-0.449-0.773q-0.203-0.875-0.203-2.734 0-1.828 0.203-2.734 0.109-0.461 0.453-0.773t0.805-0.367q1.43-0.156 4.328-0.156t4.336 0.156q0.453 0.055 0.801 0.367t0.449 0.773q0.203 0.875 0.203 2.734zM3.992 0h0.797l-0.945 3.117v2.117h-0.781v-2.117q-0.109-0.578-0.477-1.656-0.289-0.805-0.508-1.461h0.828l0.555 2.055zM6.883 2.602v1.367q0 0.633-0.219 0.922-0.289 0.398-0.828 0.398-0.523 0-0.82-0.398-0.219-0.297-0.219-0.922v-1.367q0-0.625 0.219-0.914 0.297-0.398 0.82-0.398 0.539 0 0.828 0.398 0.219 0.289 0.219 0.914zM9.5 1.336v3.898h-0.711v-0.43q-0.414 0.484-0.805 0.484-0.359 0-0.461-0.289-0.062-0.187-0.062-0.586v-3.078h0.711v2.867q0 0.258 0.008 0.273 0.023 0.172 0.164 0.172 0.211 0 0.445-0.336v-2.977h0.711z"/> </symbol></svg>
    <!--[if lt IE 10]>
        <p class="oldie">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> to better experience this site.</p>
    <![endif]-->

    <div class="site-container">
        <a href="/">Home</a>


        <main>
            <div class="container">
                <style>
    @media (max-width: 1100px) {
        .followme {
            display: none;
        }
    }

    @media (min-width: 1100px) {
        .followme {
            background: #f1f1f1;
            position: fixed;
            margin-left: 786px;
            padding: 20px;
        }
    }

    .hire-me-button {
        background-color: #2aabbf;
        color: #fff;
        border: none;
        padding: 8px 16px;
        border-radius: 15px;
    }

</style>
<div class="followme">
    <h3>Follow me on twitter</h3>
    <a href="https://twitter.com/brechtbilliet" class="twitter-follow-button"
       data-size="large"
       data-show-count="false">Follow @brechtbilliet</a>
    <script
            async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
    <br/>
    <br/>
    <a href="https://brecht.io" class="hire-me-button">Hire me</a>
</div>
<article class="post">
    <header class="post-header">
        <h2>Infinite scroll in Angular an RxJS</h2>
        <span class="date">Dec 21, 2016</span>
    </header>
    
    <div class="post-content">
        <h2 id="about-this-article">About this article</h2>

<p>This article explains how the “reactive-programming” approach helps us to create an awesome <strong>infinite-scroll-list</strong> in only a few lines of code. For this article, we are going to use <a href="http://reactivex.io/rxjs/">RxJS</a> and <a href="http://angular.io">Angular</a>. If <a href="http://reactivex.io/rxjs/">RxJS</a> is completely new, it might be a good idea to read the documentation first. Whether we use <a href="http://angular.io">Angular</a> or something else like <a href="https://facebook.github.io/react/">React</a>, it shouldn’t really interfere with the clarity of this article.</p>

<h2 id="reactive-programming">Reactive programming</h2>

<p>Reactive programming is a rather old but very powerful approach of solving problems. However, we can run into problems when trying to think in a completely reactive manner. Thinking reactively is a huge mind switch that we must make to completely accept this “new” way of coding things. The whole “Our application reacts to a state-management-layer like <a href="http://redux.js.org/">redux</a>” principle is grasped quite quickly (it’s reactive programming too), but when it comes to <a href="http://freecontent.manning.com/reactive-fundamentals-thinking-in-streams/">thinking in streams</a> it can become quite difficult in the beginning.</p>

<h3 id="why-reactive-programming">Why reactive programming?</h3>

<p>Reactive programming has some advantages over imperative programming.</p>

<ul>
  <li>No more “if this, then that” scenario’s</li>
  <li>We can forget about a ton of edge-cases&lt;</li>
  <li>It’s easy to separate presentation logic from other logic (The presentation layer will just react to streams)</li>
  <li>It’s a standard: widely supported by tons of languages</li>
  <li>When we grasp the concepts, we write complex logic in a few lines of code in a very simple manner</li>
</ul>

<p>A few days back a colleague of mine came to me with this problem: He wanted to create an <strong>infinite-scroll in Angular</strong> but he had bumped into the  boundaries of imperative programming. It turned out that an infinite-scroll-solution was actually a great use-case to explain how reactive programming can help you write better code.</p>

<h2 id="the-infinite-scroll">The infinite scroll</h2>

<h3 id="what-should-it-do">What should it do?</h3>

<p>An infinite-scroll-list, is a list where the data is being loaded asynchronosly when the user scrolls further down the application. It’s a great way to avoid a pager (where the user had to click on every time) and it can really keep the application performant. It’s an efficient way to keep bandwidth low and increase the user-experience.</p>

<p>For this scenario, let’s say that every page contains 10 results and that all the pages with results are being shown as one long scrollable list =&gt; the infinite-scroll-list.</p>

<p>Let’s list the features of what our infinite-scroll-list must do:</p>

<ul>
  <li>It should load the first page by default</li>
  <li>When the results of the first page don’t fill the page completely, it should fill page 2, and so on, until the page is full</li>
  <li>When the user scrolls down, it should load page 3, and so on…</li>
  <li>When the user resizes it’s window, and more space is being freed for results, it should load the next page</li>
  <li>It should make sure that it doesn’t load the same pages more than once (caching)</li>
</ul>

<h2 id="lets-draw-it-first">Let’s draw it first</h2>

<p>Like most coding decisions, drawing them on a whiteboard first might be a good idea. That might be a personal approach, but it helps us not to write code that will be removed/refactored later.</p>

<p>Based on the feature-list, there are three actions that will trigger the application to load data: Scrolling, resizing, and a manual action that will be triggered to manually fetch pages. When thinking reactively we can see 3 sources of events happening, let’s call them streams:</p>

<ul>
  <li>A stream of scroll events: <strong>scroll$</strong></li>
  <li>A stream of resize events: <strong>resize$</strong></li>
  <li>A manual stream where we can manually decide what page to load: <strong>pageByManual$</strong></li>
</ul>

<p><strong>Note: We will suffix the streams with $ to indicate that they are streams, this is a convention (personal preference)</strong></p>

<p>Let’s draw these streams on a whiteboard:
<img src="https://raw.githubusercontent.com/brechtbilliet/brechtbilliet.github.io/master/_posts/infinite-scroll/whiteboard1.png" alt="Whiteboard 1" /></p>

<p>These streams would contain certain values over time:
<img src="https://raw.githubusercontent.com/brechtbilliet/brechtbilliet.github.io/master/_posts/infinite-scroll/whiteboard2.png" alt="Whiteboard 2" /></p>

<p>The scroll$ stream has Y values, which we can use to calculate the page number.</p>

<p>The resize$ stream has event values. We don’t need the values but we do need to know when the user resizes its window.</p>

<p>The pageByManual$ will contain page numbers, which we can set directly since this is a subject (more on that later).</p>

<p>What if we could map all these streams, to streams that would contain page numbers? That would be awesome, because based on the page number, we could load a specific page. How we map the current streams to page number-streams is not something that we need to think about right now (we are just drawing remember?).
The next drawing might look something like this:</p>

<p><img src="https://raw.githubusercontent.com/brechtbilliet/brechtbilliet.github.io/master/_posts/infinite-scroll/whiteboard3.png" alt="Whiteboard 3" /></p>

<p>We can see that we have created the following streams based on our initial streams:</p>

<ul>
  <li><strong>pageByScroll$</strong>: which contains page numbers based on the scroll-events</li>
  <li><strong>pageByResize$</strong>: which contains page numbers based on the resize-events</li>
  <li><strong>pageByManual$</strong>: which contains page numbers based on manual events (for instance, if there is still whitespace on the screen, we have to load the next page)</li>
</ul>

<p>What if we could merge these 3 page-number streams in an efficient manner, than we would get a new stream called <strong>pageToLoad$</strong>, that would contain page numbers created by scrolling-events, resize-events, and manual events.</p>

<p><img src="https://raw.githubusercontent.com/brechtbilliet/brechtbilliet.github.io/master/_posts/infinite-scroll/whiteboard4.png" alt="Whiteboard 4" /></p>

<p>If we subscribe to the pageToLoad$ stream and than fetch data from the service, part of our infinite scroll would work. However, we were thinking reactively right? That also means, avoid subscriptions as much as possible… 
We actually need a new stream based on the pageToLoad$ stream that contains the results of our infinite scroll list…</p>

<p><img src="https://raw.githubusercontent.com/brechtbilliet/brechtbilliet.github.io/master/_posts/infinite-scroll/whiteboard5.png" alt="Whiteboard 5" /></p>

<p>Now let’s throw this in one big schema.</p>

<p><img src="https://raw.githubusercontent.com/brechtbilliet/brechtbilliet.github.io/master/_posts/infinite-scroll/whiteboard6.png" alt="Whiteboard 6" /></p>

<p>As we can see above we have 3 input streams: one for scrolling, one for resizing and a manual one.
Afterwards we have 3 page streams that are based on the input streams. When merging these streams we can create a pageToLoad$ stream. Based on that pageToLoad$ stream, we will fetch the data.</p>

<h2 id="lets-code">Let’s code</h2>

<p>We have drawn more than enough, we have a clear vision of what our inifinte-scroll-list should do, so let’s start shall we?</p>

<p>To calculate which page needs to be loaded we need 2 properties:</p>

<pre><code class="language-typescript">private itemHeight = 40;
private numberOfItems = 10;// number of items in a page
</code></pre>

<h3 id="pagebyscroll">pageByScroll$</h3>

<p>The pageByScroll$ stream might look something like this:</p>

<pre><code class="language-typescript"> private pageByScroll$ = 
 	// first of all, we want to create a stream that contains 
 	// all the scroll events that are happening in the window object
	Observable.fromEvent(window, "scroll") 
	// we are only interested in the scrollY value of these events
	// let's create a stream with only these values
	.map(() =&gt; window.scrollY)
	// create a stream with the filtered values
	// we only need the values from when we are scrolling outside
	// our viewport
	.filter(current =&gt; current &gt;=  document.body.clientHeight - window.innerHeight)
	// Only when the user stops scrolling for 200 ms, we can continue
	// so let's debounce this stream for 200 ms
	.debounceTime(200) 
	// filter out double values
	.distinct() 
	// calculate the page number
	.map(y =&gt; Math.ceil((y + window.innerHeight)/ (this.itemHeight * this.numberOfItems)));
	
	// --------1---2----3------2...
</code></pre>

<p><strong>note: In real applications you might want to use injected services for window and document</strong></p>

<h3 id="pagebyresize">pageByResize$</h3>

<p>The pageByResize$ looks like this:</p>

<pre><code class="language-typescript">  private pageByResize$ = 
  	// Now, we want to create a new stream that contains 
 	// all the resize events that are happening in the window object
	Observable.fromEvent(window, "resize")
	// when the user stops resizing for 200 ms, then we can continue
	.debounceTime(200) 
	// calculate the page number based on the window
   .map(_ =&gt; Math.ceil(
	   	(window.innerHeight + document.body.scrollTop) / 
	   	(this.itemHeight * this.numberOfItems)
   	));
   
	// --------1---2----3------2...
</code></pre>

<h3 id="pagebymanual">pageByManual$</h3>

<p>The pageByManual$ is the stream we use to have an initial value (initial page to load), but it’s also something that we need to control manually. A <a href="http://reactivex.io/documentation/subject.html">Behavior subject</a> looks perfect for the job, because we need a stream that has an initial value where we can also manually add values. A behavior subject is just a stream that has an initial value and can be manipulated over time.</p>

<pre><code class="language-typescript">private pageByManual$ = new BehaviorSubject(1);

// 1---2----3------...
</code></pre>

<h3 id="pagetoload">pageToLoad$</h3>

<p>Awesome, we have the 3 streams with page inputs, now let’s create a pageToLoad$ stream.</p>

<pre><code class="language-typescript">private pageToLoad$ = 
	// merge all the page streams and create a new stream of those
	Observable.merge(this.pageByManual$, this.pageByScroll$, this.pageByResize$)
	// create a new stream where the double values are filtered out
	.distinct() 
	// check if the page is already in the cache (just an array property in our component)
	.filter(page =&gt; this.cache[page-1] === undefined); 
</code></pre>

<h3 id="itemresults">itemResults$</h3>

<p>The hard part is over. We now have a stream with the page we have to load in there, which is super useful. We don’t need to care anymore about corner cases or other complex logic. Every time a new value in that stream is added, we just need to load the data. <strong>That’s it!!</strong></p>

<p>We will use <a href="http://reactivex.io/documentation/operators/flatmap.html">flatmap</a> for this because the fetch-data-call will return a stream as well. FlatMap (or MergeMap) will merge these 2 streams as one.</p>

<pre><code class="language-typescript">itemResults$ = this.pageToLoad$ 
	// based on that stream, load our asynchronosly data
	// flatmap is an alias for mergemap
	.flatMap((page: number) =&gt; {
		// load me some starwars characters
		return this.http.get(`https://swapi.co/api/people?page=${page}`)
			// create a stream that contains the results
			.map(resp =&gt; resp.json().results)
			.do(resp =&gt; {
				// add the page to the cache
				this.cache[page -1] = resp;
				// if the page contains enough white space, load some more data :)
				if((this.itemHeight * this.numberOfItems * page) &lt; window.innerHeight){
					this.pageByManual$.next(page + 1);
				}
			})
		})
	// eventually, just return a stream that contains the cache
	.map(_ =&gt; flatMap(this.cache)); 
</code></pre>

<h3 id="the-result">The result</h3>

<p>the complete result might look like this:  <strong>Note the <a href="https://angular.io/docs/ts/latest/guide/pipes.html#!#async-pipe">async pipe</a> that puts the whole subscription process into play</strong></p>

<pre><code class="language-typescript">@Component({
  selector: 'infinite-scroll-list',
  template: `
  &lt;table&gt;
   &lt;tbody&gt;
    &lt;tr *ngFor="let item of itemResults$|async" [style.height]="itemHeight + 'px'"&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
   &lt;/tbody&gt;
   &lt;/table&gt;
  `
})
export class InfiniteScrollListComponent {
  private cache = []; 
  private pageByManual$ = new BehaviorSubject(1);
  private itemHeight = 40;
  private numberOfItems = 10; 
  private pageByScroll$ = Observable.fromEvent(window, "scroll")
      .map(() =&gt; window.scrollY)
      .filter(current =&gt; current &gt;=  document.body.clientHeight - window.innerHeight)
      .debounceTime(200) 
      .distinct() 
      .map(y =&gt; Math.ceil((y + window.innerHeight)/ (this.itemHeight * this.numberOfItems)));
       
  private pageByResize$ = 
	Observable.fromEvent(window, "resize")
	.debounceTime(200) 
	.map(_ =&gt; Math.ceil(
	   	(window.innerHeight + document.body.scrollTop) / 
	   	(this.itemHeight * this.numberOfItems)
   	));

    
  private pageToLoad$ = Observable
    .merge(this.pageByManual$, this.pageByScroll$, this.pageByResize$)
    .distinct() 
    .filter(page =&gt; this.cache[page-1] === undefined); 
    
  itemResults$ = this.pageToLoad$ 
    .do(_ =&gt; this.loading = true)
    .flatMap((page: number) =&gt; {
      return this.http.get(`https://swapi.co/api/people?page=${page}`)
          .map(resp =&gt; resp.json().results)
      		.do(resp =&gt; {
				this.cache[page -1] = resp;
				if((this.itemHeight * this.numberOfItems * page) &lt; window.innerHeight){
					this.pageByManual$.next(page + 1);
				}
          })
    })
    .map(_ =&gt; flatMap(this.cache)); 
  
  constructor(private http: Http){ 
  } 
}
</code></pre>

<p>Here is a <a href="http://plnkr.co/edit/WewXnQRj9xBA7yPveWLQ?p=preview">working plunk</a></p>

<iframe src="https://embed.plnkr.co/plunk/WewXnQRj9xBA7yPveWLQ?show=app,preview&amp;deferRun" frameborder="0" width="100%" height="480px">
</iframe>

<p>Again, (like I try to prove in previous articles) We don’t need to use third party solutions for everything. The infinite-scroll-list doesn’t contain that much code, and it’s very flexible.
Let’s say that we would like to free up DOM-elements and use only 100 items at a time, we could just create a new stream for that :)</p>

<p>Thanks for reading, I hope you enjoyed it.</p>

    </div>
</article>


<div class="author">

    <div class="media-object">
        <img src="/img/brecht.png" alt="Brecht Billiet">
        <div class="media-bd">
            <span class="written h5">Written by</span>
            <h4><a href="http://brecht.io">Brecht Billiet</a></h4>
            <p>Software architect/trainer/coach/speaker/blogger</p>
        </div>
    </div>

</div>



<div class="comments">
    <h2>Comments</h2>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'brechtbilliet'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>



            </div>
            
        </main>
        
        <!-- Start Footer -->
<footer class="main-footer">
    <div class="container">
        <ul class="social">
            <li><a href="http://twitter.com/brechtbilliet"><svg class="icon icon-twitter"><use xlink:href="#icon-twitter"></use></svg></a></li>
            
            
            
            <li><a href="http://github.com/brechtbilliet"><svg class="icon icon-github"><use xlink:href="#icon-github"></use></svg></a></li>
            <li><a href="https://www.linkedin.com/in/brecht-billiet-58417426"><svg class="icon icon-linkedin"><use xlink:href="#icon-linkedin"></use></svg></a></li>
            
            
            <li><a href="/feed.xml"><svg class="icon icon-feed"><use xlink:href="#icon-feed"></use></svg></a></li>
        </ul>
        <small>© Blog Brecht Billiet - All rights reserved </small>
    </div>
</footer>
<!-- End Footer -->


    </div>
    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        
        ga('create', 'UA-43296458-5', 'auto');
        ga('send', 'pageview');
    </script>

    <script src="/js/all.min.js"></script>
</body>
</html>
